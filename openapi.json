{
  "openapi": "3.1.0",
  "info": {
    "title": "Syndicate GPT Actions",
    "version": "v3.2"
  },
  "servers": [
    {
      "url": "https://vault-beta-jet.vercel.app"
    }
  ],
  "paths": {
    "/api/refine": {
      "post": {
        "operationId": "refineAction",
        "summary": "Refine",
        "description": "Gera perguntas de refinamento para análises com baixa confiança.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "specialist": {
                    "type": "string"
                  },
                  "context": {
                    "type": "string"
                  },
                  "hypothesis": {
                    "type": "string"
                  },
                  "evidence": {
                    "type": "string"
                  },
                  "missingElement": {
                    "type": "string"
                  },
                  "currentConfidence": {
                    "type": "number"
                  },
                  "useFullRefinement": {
                    "type": "boolean"
                  }
                },
                "required": [
                  "specialist",
                  "context"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/analisar": {
      "post": {
        "operationId": "analisarAction",
        "summary": "Analisar",
        "description": "Solicita uma análise especializada de um registro investigativo.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "specialist": {
                    "type": "string"
                  },
                  "context": {
                    "type": "object"
                  }
                },
                "required": [
                  "specialist",
                  "context"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/review": {
      "post": {
        "operationId": "reviewAction",
        "summary": "Review",
        "description": "Executa validação cruzada entre especialistas.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "reviewer": {
                    "type": "string"
                  },
                  "originalAnalysis": {
                    "type": "object"
                  },
                  "context": {
                    "type": "object"
                  }
                },
                "required": [
                  "reviewer",
                  "originalAnalysis",
                  "context"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/pipeline": {
      "post": {
        "operationId": "pipelineAction",
        "summary": "AvançarPipeline",
        "description": "Controla a progressão do pipeline investigativo.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "currentStage": {
                    "type": "string"
                  },
                  "action": {
                    "type": "string"
                  },
                  "context": {
                    "type": "object"
                  }
                },
                "required": [
                  "currentStage",
                  "context"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/retry": {
      "post": {
        "operationId": "retryAction",
        "summary": "Retry",
        "description": "Ativa protocolo de recuperação quando uma etapa falha.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "etapaAtual": {
                    "type": "string"
                  },
                  "tipoErro": {
                    "type": "string"
                  },
                  "especialista": {
                    "type": "string"
                  },
                  "tentativaAtual": {
                    "type": "integer"
                  },
                  "confiancaAtual": {
                    "type": "number"
                  },
                  "tentativasGlobais": {
                    "type": "integer"
                  },
                  "contextoErro": {
                    "type": "object"
                  }
                },
                "required": [
                  "etapaAtual",
                  "tipoErro",
                  "tentativaAtual"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/ingest": {
      "post": {
        "operationId": "ingest",
        "summary": "SalvarRegistro",
        "description": "Persiste registros narrativos no sistema Syndicate.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "tipo_registro",
                  "autor",
                  "id_caso",
                  "etapa",
                  "especialista"
                ],
                "properties": {
                  "tipo_registro": {
                    "type": "string",
                    "enum": [
                      "hipotese",
                      "evidencia",
                      "perfil_personagem",
                      "entrada_timeline",
                      "registro_misc"
                    ],
                    "description": "Tipo do registro a ser salvo"
                  },
                  "autor": {
                    "type": "string",
                    "description": "Nome do autor do registro"
                  },
                  "id_caso": {
                    "type": "string",
                    "description": "Identificador único do caso"
                  },
                  "etapa": {
                    "type": "string",
                    "description": "Etapa atual do pipeline investigativo"
                  },
                  "especialista": {
                    "type": "string",
                    "description": "Especialista responsável pelo registro"
                  },
                  "timestamp": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Data/hora do registro (opcional)"
                  },
                  "probabilidade": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "description": "Nível de confiança/probabilidade (0-1)"
                  },
                  "hipotese": {
                    "type": "string",
                    "description": "Texto da hipótese (obrigatório para tipo_registro='hipotese')"
                  },
                  "justificativa": {
                    "type": "string",
                    "description": "Justificativa da hipótese (opcional para tipo_registro='hipotese')"
                  },
                  "acoes_recomendadas": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Lista de ações recomendadas (opcional para tipo_registro='hipotese')"
                  },
                  "nivel_confianca": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "description": "Nível de confiança da hipótese (opcional para tipo_registro='hipotese')"
                  },
                  "descricao": {
                    "type": "string",
                    "description": "Descrição do item (obrigatório para tipo_registro='evidencia' ou 'entrada_timeline')"
                  },
                  "origem": {
                    "type": "string",
                    "description": "Origem da evidência (opcional para tipo_registro='evidencia')"
                  },
                  "confiabilidade": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "description": "Confiabilidade da evidência (opcional para tipo_registro='evidencia')"
                  },
                  "nome": {
                    "type": "string",
                    "description": "Nome do personagem (obrigatório para tipo_registro='perfil_personagem')"
                  },
                  "motivacoes": {
                    "type": "string",
                    "description": "Motivações do personagem (opcional para tipo_registro='perfil_personagem')"
                  },
                  "riscos": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Riscos associados ao personagem (opcional para tipo_registro='perfil_personagem')"
                  },
                  "horario": {
                    "type": "string",
                    "description": "Horário do evento (opcional para tipo_registro='entrada_timeline')"
                  },
                  "conteudo": {
                    "type": "string",
                    "description": "Conteúdo genérico (obrigatório para tipo_registro='registro_misc')"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Registro criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "id_registro": {
                      "type": "string"
                    },
                    "tipo_registro": {
                      "type": "string"
                    },
                    "recebido_em": {
                      "type": "string"
                    },
                    "mensagem": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/status": {
      "get": {
        "operationId": "ConsultarCaso",
        "summary": "ConsultarCaso",
        "description": "Consulta o status atual de um caso investigativo no sistema Syndicate.",
        "parameters": [
          {
            "name": "idCaso",
            "in": "query",
            "required": true,
            "description": "Identificador único do caso a ser consultado",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/obi": {
      "post": {
        "operationId": "obiAction",
        "summary": "Obi",
        "description": "Consulta a decisão estratégica do Capitão Obi.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "context": {
                    "type": "object"
                  },
                  "includeDiagnostics": {
                    "type": "boolean"
                  }
                },
                "required": [
                  "context"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    }
  }
}